# Protocols {#protocols}

## Protocols for selection
1. Constructing genetic relationship matrix $\mathbf{G}$. The difference between a random mating population and inbred population is the way $\mathbf{G}$ is constructed. So for a pair of individuals $i$ and $j$, 
$$G_{ij}=\frac{1}{\tilde{m}}\sum_l^{\tilde{m}}\frac{(x_{il}-2p_l)(x_{jl}-2p_l)}{2(1+F)p_lq_l}$$
and $F=1$ for inbred lines. Please refer to Chapter \@ref(ch:basis).

2. Conducting eigenanalysis for $\mathbf{G}$, see it definition \@ref(eq:G).

3. Linear regression analysis for each SNP.

## Protocal for EigenGWAS

A simple analysis pipeline written in Rscript may be found at my [Rpub](http://rpubs.com/gc5k/EigenGWASpipeline).

## Protocol for predicted eigenvectors
The prediction accuracy can be written as
$$R^2 \approx \frac{1}{1+\frac{n_e}{m}}$$
